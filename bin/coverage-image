#!/usr/bin/env php
<?php
error_reporting(E_ALL | E_STRICT);

preg_match(
    '/^\s+Lines:\s+(\d{1,3}\.\d\d)/m',
    file_get_contents('./test/report/logfile.txt'),
    $matches
);
$percentage = intval(floor(floatval($matches[1])));
$imageSuffix = $percentage - ($percentage % 5);

copy(
    sprintf(
        './vendor/icecave/testing/images/test-coverage/test-coverage-%03d.png',
        $imageSuffix
    ),
    './test/report/coverage/coverage.png'
);
